### 块和原始设备 

### Each Unix peripheral (software or hardware) device is presented to its system users as a device file resided in the /dev directory.We open or close a device via its device file the same way we open or close a regular file.However,inside the kernel,it is a different story.Each device need a device driver,i.e. a kernel module which is used to control the operation of the device.In the Unix world,the peripheral devices are divided into the block and raw(or character) devices,two categories.The block devices behave like random access storage devices.For example,the harddisks,floppy diskettes belong to the block device category.The raw devices include all other devices.The STREAMS mechanism,implemented by Dennis Ritchie,as a whole is a set of kernel mechanisms that support the development of network services and data communication drivers.It defines interface standards for character input/output within the kernel and between the kernel and user processes.The STREAMS mechanism is composed of the utility routines,kernel facilities and a set of data structures.For example,in System V Unix,the character(software) device driver,pty,pseudo terminal driver,is developed through the STREAMS mechanism.

### For each device driver,there are several entry points.For example,it includes an initialization routine,the open and close routines,the read and write routines,and interrupt handler,etc.Also,there are predefined drive specific data structures.The data structure for a device describes the state of the drive.The driver routines can be invoked by ioctl system call and interrupt handlers,etc.Inside the kernel,there are a block device switch table and a character device switch table.These switch tables are specified in the header file /usr/include/sys/conf.h.

